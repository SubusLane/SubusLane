import pandas as pd
import numpy as np
from datetime import datetime
qa_report = pd.read_csv("C:\\Users\\subha\\Appen\\Falcon Multi Persons Video Collection 2021 - Documents\\Buir_LRAC\\Reports\\Buir_LRAC_QA_Report.csv")
#qa_report = pd.read_csv("C:\\Users\\subha\\Desktop\\Buir QA report test\\Buir_LRAC_QA_Report.csv")

#Selecting columns for individual dataframes(set of videos)
#qa_report['v2_beard_length_01'] = np.where(qa_report['v2_beard_length_01'] == np.nan, qa_report['beard_length_dance_01'], qa_report['v2_beard_length_01'])

#qa_report.loc[qa_report['v2_beard_length_01'] == '', 'v2_beard_length_01'] = qa_report['beard_length_dance_01']

#qa_report['v2_beard_length_01'].fillna(qa_report['beard_length_dance_01'], inplace=True)

qa_report["v2_beard_length_01"].fillna(qa_report["beard_length_dance_01"], inplace=True)
qa_report["v3_beard_length_01"].fillna(qa_report["beard_length_dance_01"], inplace=True)
qa_report["v2_beard_length_02"].fillna(qa_report["beard_length_dance_02"], inplace=True)
qa_report["v3_beard_length_02"].fillna(qa_report["beard_length_dance_02"], inplace=True)
qa_report["v2_beard_length_03"].fillna(qa_report["beard_length_dance_03"], inplace=True)
qa_report["v3_beard_length_03"].fillna(qa_report["beard_length_dance_03"], inplace=True)

qa_report["v2_beard_color_01"].fillna(qa_report["beard_color_01"], inplace=True)
qa_report["v3_beard_color_01"].fillna(qa_report["beard_color_01"], inplace=True)
qa_report["v2_beard_color_02"].fillna(qa_report["beard_color_02"], inplace=True)
qa_report["v3_beard_color_02"].fillna(qa_report["beard_color_02"], inplace=True)
qa_report["v2_beard_color_03"].fillna(qa_report["beard_color_03"], inplace=True)
qa_report["v3_beard_color_03"].fillna(qa_report["beard_color_03"], inplace=True)

qa_report["v2_eyebrows_thickness_01"].fillna(qa_report["eyebrows_thickness_01"], inplace=True)
qa_report["v3_eyebrows_thickness_01"].fillna(qa_report["eyebrows_thickness_01"], inplace=True)
qa_report["v2_eyebrows_thickness_02"].fillna(qa_report["eyebrows_thickness_02"], inplace=True)
qa_report["v3_eyebrows_thickness_02"].fillna(qa_report["eyebrows_thickness_02"], inplace=True)
qa_report["v2_eyebrows_thickness_03"].fillna(qa_report["eyebrows_thickness_03"], inplace=True)
qa_report["v3_eyebrows_thickness_03"].fillna(qa_report["eyebrows_thickness_03"], inplace=True)

qa_report["v2_eyebrows_style_01"].fillna(qa_report["eyebrows_style_01"], inplace=True)
qa_report["v3_eyebrows_style_01"].fillna(qa_report["eyebrows_style_01"], inplace=True)
qa_report["v2_eyebrows_style_02"].fillna(qa_report["eyebrows_style_02"], inplace=True)
qa_report["v3_eyebrows_style_02"].fillna(qa_report["eyebrows_style_02"], inplace=True)
qa_report["v2_eyebrows_style_03"].fillna(qa_report["eyebrows_style_03"], inplace=True)
qa_report["v3_eyebrows_style_03"].fillna(qa_report["eyebrows_style_03"], inplace=True)

qa_report["v2_eyes_color_01"].fillna(qa_report["eyes_color_01"], inplace=True)
qa_report["v3_eyes_color_01"].fillna(qa_report["eyes_color_01"], inplace=True)
qa_report["v2_eyes_color_02"].fillna(qa_report["eyes_color_02"], inplace=True)
qa_report["v3_eyes_color_02"].fillna(qa_report["eyes_color_02"], inplace=True)
qa_report["v2_eyes_color_03"].fillna(qa_report["eyes_color_03"], inplace=True)
qa_report["v3_eyes_color_03"].fillna(qa_report["eyes_color_03"], inplace=True)

qa_report["v2_eyes_shape_01"].fillna(qa_report["eyes_shape_01"], inplace=True)
qa_report["v3_eyes_shape_01"].fillna(qa_report["eyes_shape_01"], inplace=True)
qa_report["v2_eyes_shape_02"].fillna(qa_report["eyes_shape_02"], inplace=True)
qa_report["v3_eyes_shape_02"].fillna(qa_report["eyes_shape_02"], inplace=True)
qa_report["v2_eyes_shape_03"].fillna(qa_report["eyes_shape_03"], inplace=True)
qa_report["v3_eyes_shape_03"].fillna(qa_report["eyes_shape_03"], inplace=True)

qa_report["v2_eyes_direction_01"].fillna(qa_report["eyes_direction_01"], inplace=True)
qa_report["v3_eyes_direction_01"].fillna(qa_report["eyes_direction_01"], inplace=True)
qa_report["v2_eyes_direction_02"].fillna(qa_report["eyes_direction_02"], inplace=True)
qa_report["v3_eyes_direction_02"].fillna(qa_report["eyes_direction_02"], inplace=True)
qa_report["v2_eyes_direction_03"].fillna(qa_report["eyes_direction_03"], inplace=True)
qa_report["v3_eyes_direction_03"].fillna(qa_report["eyes_direction_03"], inplace=True)

qa_report["v2_eyes_size_01"].fillna(qa_report["eyes_size_01"], inplace=True)
qa_report["v3_eyes_size_01"].fillna(qa_report["eyes_size_01"], inplace=True)
qa_report["v2_eyes_size_02"].fillna(qa_report["eyes_size_02"], inplace=True)
qa_report["v3_eyes_size_02"].fillna(qa_report["eyes_size_02"], inplace=True)
qa_report["v2_eyes_size_03"].fillna(qa_report["eyes_size_03"], inplace=True)
qa_report["v3_eyes_size_03"].fillna(qa_report["eyes_size_03"], inplace=True)

qa_report["v2_eye_lids_type_01"].fillna(qa_report["eye_lids_type_01"], inplace=True)
qa_report["v3_eye_lids_type_01"].fillna(qa_report["eye_lids_type_01"], inplace=True)
qa_report["v2_eye_lids_type_02"].fillna(qa_report["eye_lids_type_02"], inplace=True)
qa_report["v3_eye_lids_type_02"].fillna(qa_report["eye_lids_type_02"], inplace=True)
qa_report["v2_eye_lids_type_03"].fillna(qa_report["eye_lids_type_03"], inplace=True)
qa_report["v3_eye_lids_type_03"].fillna(qa_report["eye_lids_type_03"], inplace=True)

qa_report["v2_nose_shape_01"].fillna(qa_report["nose_shape_01"], inplace=True)
qa_report["v3_nose_shape_01"].fillna(qa_report["nose_shape_01"], inplace=True)
qa_report["v2_nose_shape_02"].fillna(qa_report["nose_shape_02"], inplace=True)
qa_report["v3_nose_shape_02"].fillna(qa_report["nose_shape_02"], inplace=True)
qa_report["v2_nose_shape_03"].fillna(qa_report["nose_shape_03"], inplace=True)
qa_report["v3_nose_shape_03"].fillna(qa_report["nose_shape_03"], inplace=True)

qa_report["v2_nose_size_01"].fillna(qa_report["nose_size_01"], inplace=True)
qa_report["v3_nose_size_01"].fillna(qa_report["nose_size_01"], inplace=True)
qa_report["v2_nose_size_02"].fillna(qa_report["nose_size_02"], inplace=True)
qa_report["v3_nose_size_02"].fillna(qa_report["nose_size_02"], inplace=True)
qa_report["v2_nose_size_03"].fillna(qa_report["nose_size_03"], inplace=True)
qa_report["v3_nose_size_03"].fillna(qa_report["nose_size_03"], inplace=True)

qa_report["v2_lip_shape_01"].fillna(qa_report["lip_shape_01"], inplace=True)
qa_report["v3_lip_shape_01"].fillna(qa_report["lip_shape_01"], inplace=True)
qa_report["v2_lip_shape_02"].fillna(qa_report["lip_shape_02"], inplace=True)
qa_report["v3_lip_shape_02"].fillna(qa_report["lip_shape_02"], inplace=True)
qa_report["v2_lip_shape_03"].fillna(qa_report["lip_shape_03"], inplace=True)
qa_report["v3_lip_shape_03"].fillna(qa_report["lip_shape_03"], inplace=True)

qa_report["v2_lip_size_01"].fillna(qa_report["lip_size_01"], inplace=True)
qa_report["v3_lip_size_01"].fillna(qa_report["lip_size_01"], inplace=True)
qa_report["v2_lip_size_02"].fillna(qa_report["lip_size_02"], inplace=True)
qa_report["v3_lip_size_02"].fillna(qa_report["lip_size_02"], inplace=True)
qa_report["v2_lip_size_03"].fillna(qa_report["lip_size_03"], inplace=True)
qa_report["v3_lip_size_03"].fillna(qa_report["lip_size_03"], inplace=True)



#coltest=["v2_beard_length_01","beard_length_dance_01"]
#dftest=qa_report[coltest]
#dftest.to_csv("C:\\Users\\subha\\Desktop\\Buir QA report test\\beared.csv")

colv1 = ["_unit_id", "_created_at", "_id", "_started_at", "_tainted", "_channel", "_trust", "_worker_id", "_country", "_region", "_city", "_ip", "directory_name", "pin", "script_name", "script_num", "device_model", "qa_decesion_daily_act", "rejection_reason_01", "input_comment_daily_act", "input_comment_metadata", "number_of_people1", "background_uniformity_video_daily_act", "scenery_video_daily_act", "lighting_video_daily_act", "subject_exposure_daily_act", "people_seen_in_background", "pets_seen_in_foreground", "type", "orientation", "camera_setting1", "skin_tone", "skin_tone2", "skin_tone3", "gender", "gender2", "gender3", "age", "age2", "age3", "hair_length", "hair_length2", "hair_length3", "hair_style", "hair_style2", "hair_style3", "hair_color", "hair_color2", "hair_color3", "beard_length_dance_01", "beard_length_dance_02", "beard_length_dance_03", "beard_color_01", "beard_color_02", "beard_color_03", "visible_tattoos_01", "visible_tattoos_02", "visible_tattoos_03", "eyebrows_thickness_01", "eyebrows_thickness_02", "eyebrows_thickness_03","eyebrows_style_01","eyebrows_style_02","eyebrows_style_03", "eyes_color_01", "eyes_color_02", "eyes_color_03", "eyes_shape_01", "eyes_shape_02", "eyes_shape_03", "eyes_direction_01", "eyes_direction_02", "eyes_direction_03", "eyes_size_01", "eyes_size_02", "eyes_size_03", "eye_lids_type_01", "eye_lids_type_02", "eye_lids_type_03", "nose_shape_01", "nose_shape_02", "nose_shape_03", "nose_size_01", "nose_size_02", "nose_size_03", "lip_shape_01", "lip_shape_02", "lip_shape_03", "lip_size_01", "lip_size_02", "lip_size_03", "over_ear_headphones_01", "over_ear_headphones_02", "over_ear_headphones_03", "in_ear_headphones_01", "in_ear_headphones_02", "in_ear_headphones_03", "wearing_mask_01", "wearing_mask_02", "wearing_mask_03", "glasses_style_01", "glasses_style_02", "glasses_style_03", "glasses_frames_01", "glasses_frames_02", "glasses_frames_03", "glasses_lens_01", "glasses_lens_02", "glasses_lens_03", "wearing_headwear_01", "wearing_headwear_02", "wearing_headwear_03", "wearing_single_clothing_piece_01", "wearing_single_clothing_piece_02", "wearing_single_clothing_piece_03", "clothing_matches_bg_01", "clothing_matches_bg_02", "clothing_matches_bg_03", "top_clothing_fit_01", "top_clothing_fit_02", "top_clothing_fit_03", "bottom_clothing_fit_01", "bottom_clothing_fit_02", "bottom_clothing_fit_03", "holding_sign_01", "holding_sign_02", "holding_sign_03", "holding_phone_01", "holding_phone_02", "holding_phone_03", "hands_are_moving_01", "hands_are_moving_02", "hands_are_moving_03", "hands_stretched_01", "hands_stretched_02", "hands_stretched_03", "pose_01", "pose_02", "pose_03", "sitting_or_standing_01", "sitting_or_standing_02", "sitting_or_standing_03", "screen_moving_with_person_01", "screen_moving_with_person_02", "screen_moving_with_person_03", "performing_activity_01", "performing_activity_02", "performing_activity_03", "single_person_comment", "two_person_comment", "three_person_comment", "video_01_url","activity_01"]
colv2 = ["_unit_id", "_created_at", "_id", "_started_at", "_tainted", "_channel", "_trust", "_worker_id", "_country", "_region", "_city", "_ip", "directory_name", "pin", "script_name", "script_num", "device_model", "qa_decesion_walk", "rejection_reason_02", "input_comment_qa_walk", "input_comment_metadata2", "number_of_people2", "background_uniformity_video_walk", "scenery_video_walk", "lighting_video_walk", "subject_exposure_walk:", "people_seen_in_background2", "pets_seen_in_foreground2", "type2", "orientation2", "camera_setting2", "skin_tone", "skin_tone2", "skin_tone3", "gender", "gender2", "gender3", "age", "age2", "age3", "hair_length", "hair_length2", "hair_length3", "hair_style", "hair_style2", "hair_style3", "hair_color", "hair_color2", "hair_color3", "v2_beard_length_01", "v2_beard_length_02", "v2_beard_length_03", "v2_beard_color_01", "v2_beard_color_02", "v2_beard_color_03", "v2_visible_tattoos_01", "v2_visible_tattoos_02", "v2_visible_tattoos_03", "v2_eyebrows_thickness_01", "v2_eyebrows_thickness_02", "v2_eyebrows_thickness_03","v2_eyebrows_style_01","v2_eyebrows_style_02","v2_eyebrows_style_03", "v2_eyes_color_01", "v2_eyes_color_02", "v2_eyes_color_03", "v2_eyes_shape_01", "v2_eyes_shape_02", "v2_eyes_shape_03", "v2_eyes_direction_01", "v2_eyes_direction_02", "v2_eyes_direction_03", "v2_eyes_size_01", "v2_eyes_size_02", "v2_eyes_size_03", "v2_eye_lids_type_01", "v2_eye_lids_type_02", "v2_eye_lids_type_03", "v2_nose_shape_01", "v2_nose_shape_02", "v2_nose_shape_03", "v2_nose_size_01", "v2_nose_size_02", "v2_nose_size_03", "v2_lip_shape_01", "v2_lip_shape_02", "v2_lip_shape_03", "v2_lip_size_01", "v2_lip_size_02", "v2_lip_size_03", "v2_over_ear_headphones_01", "v2_over_ear_headphones_02", "v2_over_ear_headphones_03", "v2_in_ear_headphones_01", "v2_in_ear_headphones_02", "v2_in_ear_headphones_03", "v2_wearing_mask_01", "v2_wearing_mask_02", "v2_wearing_mask_03", "v2_glasses_style_01", "v2_glasses_style_02", "v2_glasses_style_03", "v2_glasses_frames_01", "v2_glasses_frames_02", "v2_glasses_frames_03", "v2_glasses_lens_01", "v2_glasses_lens_02", "v2_glasses_lens_03", "v2_wearing_headwear_01", "v2_wearing_headwear_02", "v2_wearing_headwear_03", "v2_wearing_single_clothing_piece_01", "v2_wearing_single_clothing_piece_02", "v2_wearing_single_clothing_piece_03", "v2_clothing_matches_bg_01", "v2_clothing_matches_bg_02", "v2_clothing_matches_bg_03", "v2_top_clothing_fit_01", "v2_top_clothing_fit_02", "v2_top_clothing_fit_03", "v2_bottom_clothing_fit_01", "v2_bottom_clothing_fit_02", "v2_bottom_clothing_fit_03", "v2_holding_sign_01", "v2_holding_sign_02", "v2_holding_sign_03", "v2_holding_phone_01", "v2_holding_phone_02", "v2_holding_phone_03", "v2_hands_are_moving_01", "v2_hands_are_moving_02", "v2_hands_are_moving_03", "v2_hands_stretched_01", "v2_hands_stretched_02", "v2_hands_stretched_03", "v2_pose_01", "v2_pose_02", "v2_pose_03", "v2_sitting_or_standing_01", "v2_sitting_or_standing_02", "v2_sitting_or_standing_03", "v2_screen_moving_with_person_01", "v2_screen_moving_with_person_02", "v2_screen_moving_with_person_03", "v2_performing_activity_01", "v2_performing_activity_02", "v2_performing_activity_03", "single_person_comment", "two_person_comment", "three_person_comment", "video_02_url","activity_02"]
colv3 = ["_unit_id", "_created_at", "_id", "_started_at", "_tainted", "_channel", "_trust", "_worker_id", "_country", "_region", "_city", "_ip", "directory_name", "pin", "script_name", "script_num", "device_model", "qa_decesion_dance", "rejection_reason_03", "input_comment_qa_dance", "input_comment_metadata3", "number_of_people3", "background_uniformity_video_dance", "scenery_video_dance", "lighting_video_dance", "subject_exposure_dance", "people_seen_in_background3", "pets_seen_in_foreground3", "type3", "orientation3", "camera_setting3", "skin_tone", "skin_tone2", "skin_tone3", "gender", "gender2", "gender3", "age", "age2", "age3", "hair_length", "hair_length2", "hair_length3", "hair_style", "hair_style2", "hair_style3", "hair_color", "hair_color2", "hair_color3", "v3_beard_length_01", "v3_beard_length_02", "v3_beard_length_03", "v3_beard_color_01", "v3_beard_color_02", "v3_beard_color_03", "v3_visible_tattoos_01", "v3_visible_tattoos_02", "v3_visible_tattoos_03", "v3_eyebrows_thickness_01", "v3_eyebrows_thickness_02", "v3_eyebrows_thickness_03","v3_eyebrows_style_01","v3_eyebrows_style_02","v3_eyebrows_style_03", "v3_eyes_color_01", "v3_eyes_color_02", "v3_eyes_color_03", "v3_eyes_shape_01", "v3_eyes_shape_02", "v3_eyes_shape_03", "v3_eyes_direction_01", "v3_eyes_direction_02", "v3_eyes_direction_03", "v3_eyes_size_01", "v3_eyes_size_02", "v3_eyes_size_03", "v3_eye_lids_type_01", "v3_eye_lids_type_02", "v3_eye_lids_type_03", "v3_nose_shape_01", "v3_nose_shape_02", "v3_nose_shape_03", "v3_nose_size_01", "v3_nose_size_02", "v3_nose_size_03", "v3_lip_shape_01", "v3_lip_shape_02", "v3_lip_shape_03", "v3_lip_size_01", "v3_lip_size_02", "v3_lip_size_03", "v3_over_ear_headphones_01", "v3_over_ear_headphones_02", "v3_over_ear_headphones_03", "v3_in_ear_headphones_01", "v3_in_ear_headphones_02", "v3_in_ear_headphones_03", "v3_wearing_mask_01", "v3_wearing_mask_02", "v3_wearing_mask_03", "v3_glasses_style_01", "v3_glasses_style_02", "v3_glasses_style_03", "v3_glasses_frames_01", "v3_glasses_frames_02", "v3_glasses_frames_03", "v3_glasses_lens_01", "v3_glasses_lens_02", "v3_glasses_lens_03", "v3_wearing_headwear_01", "v3_wearing_headwear_02", "v3_wearing_headwear_03", "v3_wearing_single_clothing_piece_01", "v3_wearing_single_clothing_piece_02", "v3_wearing_single_clothing_piece_03", "v3_clothing_matches_bg_01", "v3_clothing_matches_bg_02", "v3_clothing_matches_bg_03", "v3_top_clothing_fit_01", "v3_top_clothing_fit_02", "v3_top_clothing_fit_03", "v3_bottom_clothing_fit_01", "v3_bottom_clothing_fit_02", "v3_bottom_clothing_fit_03", "v3_holding_sign_01", "v3_holding_sign_02", "v3_holding_sign_03", "v3_holding_phone_01", "v3_holding_phone_02", "v3_holding_phone_03", "v3_hands_are_moving_01", "v3_hands_are_moving_02", "v3_hands_are_moving_03", "v3_hands_stretched_01", "v3_hands_stretched_02", "v3_hands_stretched_03", "v3_pose_01", "v3_pose_02", "v3_pose_03", "v3_sitting_or_standing_01", "v3_sitting_or_standing_02", "v3_sitting_or_standing_03", "v3_screen_moving_with_person_01", "v3_screen_moving_with_person_02", "v3_screen_moving_with_person_03", "v3_performing_activity_01", "v3_performing_activity_02", "v3_performing_activity_03", "single_person_comment", "two_person_comment", "three_person_comment", "video_03_url","activity_03"]
#individual dataframes
dfv1 = qa_report[colv1]
dfv1.rename(columns={"_unit_id":"_unit_id","_created_at":"_created_at","_id":"_id","_started_at":"_started_at","_tainted":"_tainted","_channel":"_channel","_trust":"_trust","_worker_id":"_worker_id","_country":"_country","_region":"_region","_city":"_city","_ip":"_ip","directory_name":"directory_name","pin":"pin","script_name":"script_name","script_num":"script_num","device_model":"device_model","qa_decesion_daily_act":"qa_decesion","rejection_reason_01":"rejection_reason_01","input_comment_daily_act":"input_comment","input_comment_metadata":"input_comment_metadata","number_of_people1":"number_of_people1","background_uniformity_video_daily_act":"background_uniformity_video","scenery_video_daily_act":"scenery_video","lighting_video_daily_act":"lighting_video","subject_exposure_daily_act":"subject_exposure","people_seen_in_background":"people_seen_in_background","pets_seen_in_foreground":"pets_seen_in_foreground","type":"type","orientation":"orientation","camera_setting1":"camera_setting1","skin_tone":"skin_tone","skin_tone2":"skin_tone2","skin_tone3":"skin_tone3","gender":"gender","gender2":"gender2","gender3":"gender3","age":"age","age2":"age2","age3":"age3","hair_length":"hair_length","hair_length2":"hair_length2","hair_length3":"hair_length3","hair_style":"hair_style","hair_style2":"hair_style2","hair_style3":"hair_style3","hair_color":"hair_color","hair_color2":"hair_color2","hair_color3":"hair_color3","beard_length_dance_01":"beard_length_01","beard_length_dance_02":"beard_length_02","beard_length_dance_03":"beard_length_03","beard_color_01":"beard_color_01","beard_color_02":"beard_color_02","beard_color_03":"beard_color_03","visible_tattoos_01":"visible_tattoos_01","visible_tattoos_02":"visible_tattoos_02","visible_tattoos_03":"visible_tattoos_03","eyebrows_thickness_01":"eyebrows_thickness_01","eyebrows_thickness_02":"eyebrows_thickness_02","eyebrows_thickness_03":"eyebrows_thickness_03","eyes_color_01":"eyes_color_01","eyes_color_02":"eyes_color_02","eyes_color_03":"eyes_color_03","eyes_shape_01":"eyes_shape_01","eyes_shape_02":"eyes_shape_02","eyes_shape_03":"eyes_shape_03","eyes_direction_01":"eyes_direction_01","eyes_direction_02":"eyes_direction_02","eyes_direction_03":"eyes_direction_03","eyes_size_01":"eyes_size_01","eyes_size_02":"eyes_size_02","eyes_size_03":"eyes_size_03","eye_lids_type_01":"eye_lids_type_01","eye_lids_type_02":"eye_lids_type_02","eye_lids_type_03":"eye_lids_type_03","nose_shape_01":"nose_shape_01","nose_shape_02":"nose_shape_02","nose_shape_03":"nose_shape_03","nose_size_01":"nose_size_01","nose_size_02":"nose_size_02","nose_size_03":"nose_size_03","lip_shape_01":"lip_shape_01","lip_shape_02":"lip_shape_02","lip_shape_03":"lip_shape_03","lip_size_01":"lip_size_01","lip_size_02":"lip_size_02","lip_size_03":"lip_size_03","over_ear_headphones_01":"over_ear_headphones_01","over_ear_headphones_02":"over_ear_headphones_02","over_ear_headphones_03":"over_ear_headphones_03","in_ear_headphones_01":"in_ear_headphones_01","in_ear_headphones_02":"in_ear_headphones_02","in_ear_headphones_03":"in_ear_headphones_03","wearing_mask_01":"wearing_mask_01","wearing_mask_02":"wearing_mask_02","wearing_mask_03":"wearing_mask_03","glasses_style_01":"glasses_style_01","glasses_style_02":"glasses_style_02","glasses_style_03":"glasses_style_03","glasses_frames_01":"glasses_frames_01","glasses_frames_02":"glasses_frames_02","glasses_frames_03":"glasses_frames_03","glasses_lens_01":"glasses_lens_01","glasses_lens_02":"glasses_lens_02","glasses_lens_03":"glasses_lens_03","wearing_headwear_01":"wearing_headwear_01","wearing_headwear_02":"wearing_headwear_02","wearing_headwear_03":"wearing_headwear_03","wearing_single_clothing_piece_01":"wearing_single_clothing_piece_01","wearing_single_clothing_piece_02":"wearing_single_clothing_piece_02","wearing_single_clothing_piece_03":"wearing_single_clothing_piece_03","clothing_matches_bg_01":"clothing_matches_bg_01","clothing_matches_bg_02":"clothing_matches_bg_02","clothing_matches_bg_03":"clothing_matches_bg_03","top_clothing_fit_01":"top_clothing_fit_01","top_clothing_fit_02":"top_clothing_fit_02","top_clothing_fit_03":"top_clothing_fit_03","bottom_clothing_fit_01":"bottom_clothing_fit_01","bottom_clothing_fit_02":"bottom_clothing_fit_02","bottom_clothing_fit_03":"bottom_clothing_fit_03","holding_sign_01":"holding_sign_01","holding_sign_02":"holding_sign_02","holding_sign_03":"holding_sign_03","holding_phone_01":"holding_phone_01","holding_phone_02":"holding_phone_02","holding_phone_03":"holding_phone_03","hands_are_moving_01":"hands_are_moving_01","hands_are_moving_02":"hands_are_moving_02","hands_are_moving_03":"hands_are_moving_03","hands_stretched_01":"hands_stretched_01","hands_stretched_02":"hands_stretched_02","hands_stretched_03":"hands_stretched_03","pose_01":"pose_01","pose_02":"pose_02","pose_03":"pose_03","sitting_or_standing_01":"sitting_or_standing_01","sitting_or_standing_02":"sitting_or_standing_02","sitting_or_standing_03":"sitting_or_standing_03","screen_moving_with_person_01":"screen_moving_with_person_01","screen_moving_with_person_02":"screen_moving_with_person_02","screen_moving_with_person_03":"screen_moving_with_person_03","performing_activity_01":"performing_activity_01","performing_activity_02":"performing_activity_02","performing_activity_03":"performing_activity_03","single_person_comment":"single_person_comment","two_person_comment":"two_person_comment","three_person_comment":"three_person_comment","video_01_url":"video_01_url","activity_01":"activity"},inplace=True);
#print(len(dfv1.index))
dfv2=qa_report[colv2]
dfv2.rename(columns={"_unit_id":"_unit_id","_created_at":"_created_at","_id":"_id","_started_at":"_started_at","_tainted":"_tainted","_channel":"_channel","_trust":"_trust","_worker_id":"_worker_id","_country":"_country","_region":"_region","_city":"_city","_ip":"_ip","directory_name":"directory_name","pin":"pin","script_name":"script_name","script_num":"script_num","device_model":"device_model","qa_decesion_walk":"qa_decesion","rejection_reason_02":"rejection_reason_01","input_comment_qa_walk":"input_comment","input_comment_metadata2":"input_comment_metadata","number_of_people2":"number_of_people1","background_uniformity_video_walk":"background_uniformity_video","scenery_video_walk":"scenery_video","lighting_video_walk":"lighting_video","subject_exposure_walk:":"subject_exposure","people_seen_in_background2":"people_seen_in_background","pets_seen_in_foreground2":"pets_seen_in_foreground","type2":"type","orientation2":"orientation","camera_setting2":"camera_setting1","skin_tone":"skin_tone","skin_tone2":"skin_tone2","skin_tone3":"skin_tone3","gender":"gender","gender2":"gender2","gender3":"gender3","age":"age","age2":"age2","age3":"age3","hair_length":"hair_length","hair_length2":"hair_length2","hair_length3":"hair_length3","hair_style":"hair_style","hair_style2":"hair_style2","hair_style3":"hair_style3","hair_color":"hair_color","hair_color2":"hair_color2","hair_color3":"hair_color3","v2_beard_length_01":"beard_length_01","v2_beard_length_02":"beard_length_02","v2_beard_length_03":"beard_length_03","v2_beard_color_01":"beard_color_01","v2_beard_color_02":"beard_color_02","v2_beard_color_03":"beard_color_03","v2_visible_tattoos_01":"visible_tattoos_01","v2_visible_tattoos_02":"visible_tattoos_02","v2_visible_tattoos_03":"visible_tattoos_03","v2_eyebrows_thickness_01":"eyebrows_thickness_01","v2_eyebrows_thickness_02":"eyebrows_thickness_02","v2_eyebrows_thickness_03":"eyebrows_thickness_03","v2_eyebrows_style_01":"eyebrows_style_01","v2_eyebrows_style_02":"eyebrows_style_02","v2_eyebrows_style_03":"eyebrows_style_03","v2_eyes_color_01":"eyes_color_01","v2_eyes_color_02":"eyes_color_02","v2_eyes_color_03":"eyes_color_03","v2_eyes_shape_01":"eyes_shape_01","v2_eyes_shape_02":"eyes_shape_02","v2_eyes_shape_03":"eyes_shape_03","v2_eyes_direction_01":"eyes_direction_01","v2_eyes_direction_02":"eyes_direction_02","v2_eyes_direction_03":"eyes_direction_03","v2_eyes_size_01":"eyes_size_01","v2_eyes_size_02":"eyes_size_02","v2_eyes_size_03":"eyes_size_03","v2_eye_lids_type_01":"eye_lids_type_01","v2_eye_lids_type_02":"eye_lids_type_02","v2_eye_lids_type_03":"eye_lids_type_03","v2_nose_shape_01":"nose_shape_01","v2_nose_shape_02":"nose_shape_02","v2_nose_shape_03":"nose_shape_03","v2_nose_size_01":"nose_size_01","v2_nose_size_02":"nose_size_02","v2_nose_size_03":"nose_size_03","v2_lip_shape_01":"lip_shape_01","v2_lip_shape_02":"lip_shape_02","v2_lip_shape_03":"lip_shape_03","v2_lip_size_01":"lip_size_01","v2_lip_size_02":"lip_size_02","v2_lip_size_03":"lip_size_03","v2_over_ear_headphones_01":"over_ear_headphones_01","v2_over_ear_headphones_02":"over_ear_headphones_02","v2_over_ear_headphones_03":"over_ear_headphones_03","v2_in_ear_headphones_01":"in_ear_headphones_01","v2_in_ear_headphones_02":"in_ear_headphones_02","v2_in_ear_headphones_03":"in_ear_headphones_03","v2_wearing_mask_01":"wearing_mask_01","v2_wearing_mask_02":"wearing_mask_02","v2_wearing_mask_03":"wearing_mask_03","v2_glasses_style_01":"glasses_style_01","v2_glasses_style_02":"glasses_style_02","v2_glasses_style_03":"glasses_style_03","v2_glasses_frames_01":"glasses_frames_01","v2_glasses_frames_02":"glasses_frames_02","v2_glasses_frames_03":"glasses_frames_03","v2_glasses_lens_01":"glasses_lens_01","v2_glasses_lens_02":"glasses_lens_02","v2_glasses_lens_03":"glasses_lens_03","v2_wearing_headwear_01":"wearing_headwear_01","v2_wearing_headwear_02":"wearing_headwear_02","v2_wearing_headwear_03":"wearing_headwear_03","v2_wearing_single_clothing_piece_01":"wearing_single_clothing_piece_01","v2_wearing_single_clothing_piece_02":"wearing_single_clothing_piece_02","v2_wearing_single_clothing_piece_03":"wearing_single_clothing_piece_03","v2_clothing_matches_bg_01":"clothing_matches_bg_01","v2_clothing_matches_bg_02":"clothing_matches_bg_02","v2_clothing_matches_bg_03":"clothing_matches_bg_03","v2_top_clothing_fit_01":"top_clothing_fit_01","v2_top_clothing_fit_02":"top_clothing_fit_02","v2_top_clothing_fit_03":"top_clothing_fit_03","v2_bottom_clothing_fit_01":"bottom_clothing_fit_01","v2_bottom_clothing_fit_02":"bottom_clothing_fit_02","v2_bottom_clothing_fit_03":"bottom_clothing_fit_03","v2_holding_sign_01":"holding_sign_01","v2_holding_sign_02":"holding_sign_02","v2_holding_sign_03":"holding_sign_03","v2_holding_phone_01":"holding_phone_01","v2_holding_phone_02":"holding_phone_02","v2_holding_phone_03":"holding_phone_03","v2_hands_are_moving_01":"hands_are_moving_01","v2_hands_are_moving_02":"hands_are_moving_02","v2_hands_are_moving_03":"hands_are_moving_03","v2_hands_stretched_01":"hands_stretched_01","v2_hands_stretched_02":"hands_stretched_02","v2_hands_stretched_03":"hands_stretched_03","v2_pose_01":"pose_01","v2_pose_02":"pose_02","v2_pose_03":"pose_03","v2_sitting_or_standing_01":"sitting_or_standing_01","v2_sitting_or_standing_02":"sitting_or_standing_02","v2_sitting_or_standing_03":"sitting_or_standing_03","v2_screen_moving_with_person_01":"screen_moving_with_person_01","v2_screen_moving_with_person_02":"screen_moving_with_person_02","v2_screen_moving_with_person_03":"screen_moving_with_person_03","v2_performing_activity_01":"performing_activity_01","v2_performing_activity_02":"performing_activity_02","v2_performing_activity_03":"performing_activity_03","single_person_comment":"single_person_comment","two_person_comment":"two_person_comment","three_person_comment":"three_person_comment","video_02_url":"video_01_url","activity_02":"activity"},inplace=True)
#print(len(dfv2.index))
dfv3=qa_report[colv3]
dfv3.rename(columns={"_unit_id":"_unit_id","_created_at":"_created_at","_id":"_id","_started_at":"_started_at","_tainted":"_tainted","_channel":"_channel","_trust":"_trust","_worker_id":"_worker_id","_country":"_country","_region":"_region","_city":"_city","_ip":"_ip","directory_name":"directory_name","pin":"pin","script_name":"script_name","script_num":"script_num","device_model":"device_model","qa_decesion_dance":"qa_decesion","rejection_reason_03":"rejection_reason_01","input_comment_qa_dance":"input_comment","input_comment_metadata3":"input_comment_metadata","number_of_people3":"number_of_people1","background_uniformity_video_dance":"background_uniformity_video","scenery_video_dance":"scenery_video","lighting_video_dance":"lighting_video","subject_exposure_dance":"subject_exposure","people_seen_in_background3":"people_seen_in_background","pets_seen_in_foreground3":"pets_seen_in_foreground","type3":"type","orientation3":"orientation","camera_setting3":"camera_setting1","skin_tone":"skin_tone","skin_tone2":"skin_tone2","skin_tone3":"skin_tone3","gender":"gender","gender2":"gender2","gender3":"gender3","age":"age","age2":"age2","age3":"age3","hair_length":"hair_length","hair_length2":"hair_length2","hair_length3":"hair_length3","hair_style":"hair_style","hair_style2":"hair_style2","hair_style3":"hair_style3","hair_color":"hair_color","hair_color2":"hair_color2","hair_color3":"hair_color3","v3_beard_length_01":"beard_length_01","v3_beard_length_02":"beard_length_02","v3_beard_length_03":"beard_length_03","v3_beard_color_01":"beard_color_01","v3_beard_color_02":"beard_color_02","v3_beard_color_03":"beard_color_03","v3_visible_tattoos_01":"visible_tattoos_01","v3_visible_tattoos_02":"visible_tattoos_02","v3_visible_tattoos_03":"visible_tattoos_03","v3_eyebrows_thickness_01":"eyebrows_thickness_01","v3_eyebrows_thickness_02":"eyebrows_thickness_02","v3_eyebrows_thickness_03":"eyebrows_thickness_03","v3_eyebrows_style_01":"eyebrows_style_01","v3_eyebrows_style_02":"eyebrows_style_02","v3_eyebrows_style_03":"eyebrows_style_03","v3_eyes_color_01":"eyes_color_01","v3_eyes_color_02":"eyes_color_02","v3_eyes_color_03":"eyes_color_03","v3_eyes_shape_01":"eyes_shape_01","v3_eyes_shape_02":"eyes_shape_02","v3_eyes_shape_03":"eyes_shape_03","v3_eyes_direction_01":"eyes_direction_01","v3_eyes_direction_02":"eyes_direction_02","v3_eyes_direction_03":"eyes_direction_03","v3_eyes_size_01":"eyes_size_01","v3_eyes_size_02":"eyes_size_02","v3_eyes_size_03":"eyes_size_03","v3_eye_lids_type_01":"eye_lids_type_01","v3_eye_lids_type_02":"eye_lids_type_02","v3_eye_lids_type_03":"eye_lids_type_03","v3_nose_shape_01":"nose_shape_01","v3_nose_shape_02":"nose_shape_02","v3_nose_shape_03":"nose_shape_03","v3_nose_size_01":"nose_size_01","v3_nose_size_02":"nose_size_02","v3_nose_size_03":"nose_size_03","v3_lip_shape_01":"lip_shape_01","v3_lip_shape_02":"lip_shape_02","v3_lip_shape_03":"lip_shape_03","v3_lip_size_01":"lip_size_01","v3_lip_size_02":"lip_size_02","v3_lip_size_03":"lip_size_03","v3_over_ear_headphones_01":"over_ear_headphones_01","v3_over_ear_headphones_02":"over_ear_headphones_02","v3_over_ear_headphones_03":"over_ear_headphones_03","v3_in_ear_headphones_01":"in_ear_headphones_01","v3_in_ear_headphones_02":"in_ear_headphones_02","v3_in_ear_headphones_03":"in_ear_headphones_03","v3_wearing_mask_01":"wearing_mask_01","v3_wearing_mask_02":"wearing_mask_02","v3_wearing_mask_03":"wearing_mask_03","v3_glasses_style_01":"glasses_style_01","v3_glasses_style_02":"glasses_style_02","v3_glasses_style_03":"glasses_style_03","v3_glasses_frames_01":"glasses_frames_01","v3_glasses_frames_02":"glasses_frames_02","v3_glasses_frames_03":"glasses_frames_03","v3_glasses_lens_01":"glasses_lens_01","v3_glasses_lens_02":"glasses_lens_02","v3_glasses_lens_03":"glasses_lens_03","v3_wearing_headwear_01":"wearing_headwear_01","v3_wearing_headwear_02":"wearing_headwear_02","v3_wearing_headwear_03":"wearing_headwear_03","v3_wearing_single_clothing_piece_01":"wearing_single_clothing_piece_01","v3_wearing_single_clothing_piece_02":"wearing_single_clothing_piece_02","v3_wearing_single_clothing_piece_03":"wearing_single_clothing_piece_03","v3_clothing_matches_bg_01":"clothing_matches_bg_01","v3_clothing_matches_bg_02":"clothing_matches_bg_02","v3_clothing_matches_bg_03":"clothing_matches_bg_03","v3_top_clothing_fit_01":"top_clothing_fit_01","v3_top_clothing_fit_02":"top_clothing_fit_02","v3_top_clothing_fit_03":"top_clothing_fit_03","v3_bottom_clothing_fit_01":"bottom_clothing_fit_01","v3_bottom_clothing_fit_02":"bottom_clothing_fit_02","v3_bottom_clothing_fit_03":"bottom_clothing_fit_03","v3_holding_sign_01":"holding_sign_01","v3_holding_sign_02":"holding_sign_02","v3_holding_sign_03":"holding_sign_03","v3_holding_phone_01":"holding_phone_01","v3_holding_phone_02":"holding_phone_02","v3_holding_phone_03":"holding_phone_03","v3_hands_are_moving_01":"hands_are_moving_01","v3_hands_are_moving_02":"hands_are_moving_02","v3_hands_are_moving_03":"hands_are_moving_03","v3_hands_stretched_01":"hands_stretched_01","v3_hands_stretched_02":"hands_stretched_02","v3_hands_stretched_03":"hands_stretched_03","v3_pose_01":"pose_01","v3_pose_02":"pose_02","v3_pose_03":"pose_03","v3_sitting_or_standing_01":"sitting_or_standing_01","v3_sitting_or_standing_02":"sitting_or_standing_02","v3_sitting_or_standing_03":"sitting_or_standing_03","v3_screen_moving_with_person_01":"screen_moving_with_person_01","v3_screen_moving_with_person_02":"screen_moving_with_person_02","v3_screen_moving_with_person_03":"screen_moving_with_person_03","v3_performing_activity_01":"performing_activity_01","v3_performing_activity_02":"performing_activity_02","v3_performing_activity_03":"performing_activity_03","single_person_comment":"single_person_comment","two_person_comment":"two_person_comment","three_person_comment":"three_person_comment","video_03_url":"video_01_url","activity_03":"activity"},inplace=True)
#print(len(dfv3.index))
dfvsf = dfv1.append([dfv2, dfv3])
dfvsf=dfvsf.sort_values(['directory_name','_started_at'],ascending=[True, False])
#print(len(dfvsf.index))

#creating few columns
dfvsf["ac_id"]=""
dfvsf["action"]=""
dfvsf["participant_id"]=""
dfvsf["participant_id_01"]=""
dfvsf["participant_id_02"]=""
dfvsf["participant_id_03"]=""
dfvsf["country_residence_01"]="" #dfvsf["_country"]
dfvsf["state_residence_01"]=""
dfvsf["country_residence_02"]="" #dfvsf["_country"]
dfvsf["state_residence_02"]=""
dfvsf["country_residence_03"]="" #dfvsf["_country"]
dfvsf["state_residence_03"]=""

dfvsf.rename(columns={"rejection_reason_01":"rejection_reason","directory_name":"session_name","video_01_url":"file_url","number_of_people1":"number_of_people","background_uniformity_video":"background_uniformity","scenery_video":"scenery","lighting_video":"Lighting","camera_setting1":"camera_setting","skin_tone":"skin_tone_01","skin_tone2":"skin_tone_02","skin_tone3":"skin_tone_03","gender":"gender_01","gender2":"gender_02","gender3":"gender_03","age":"age_01","age2":"age_02","age3":"age_03","hair_length":"hair_length_01","hair_length2":"hair_length_02","hair_length3":"hair_length_03","hair_style":"hair_style_01","hair_style2":"hair_style_02","hair_style3":"hair_style_03","hair_color":"hair_color_01","hair_color2":"hair_color_02","hair_color3":"hair_color_03"},inplace=True);



#Getting ac id from pin
dfvsf['extra_pin']=dfvsf['pin']
dfvsf[['extra_pin','ac_id']] = dfvsf['extra_pin'].str.split('_',expand=True)
dfvsf['participant_id']=dfvsf['ac_id']
dfvsf['participant_id_01'] = dfvsf['participant_id'].astype(str)+"_01"
dfvsf['participant_id_02'] = dfvsf['participant_id'].astype(str)+"_02"
dfvsf['participant_id_03'] = dfvsf['participant_id'].astype(str)+"_03"

#final columns to get
final_cols=["_unit_id","_created_at","_id","_started_at","_worker_id","_country","_region","_city","_ip","pin","script_name","script_num","qa_decesion","rejection_reason","input_comment","input_comment_metadata","single_person_comment","two_person_comment","three_person_comment","session_name","file_url","ac_id","action","participant_id","number_of_people","people_seen_in_background","pets_seen_in_foreground","background_uniformity","scenery","Lighting","subject_exposure","type","device_model","orientation","camera_setting","participant_id_01","skin_tone_01","gender_01","age_01","hair_length_01","hair_style_01","hair_color_01","beard_length_01","beard_color_01","visible_tattoos_01","eyebrows_thickness_01","eyebrows_style_01","eyes_color_01","eyes_shape_01","eyes_direction_01","eyes_size_01","eye_lids_type_01","nose_shape_01","nose_size_01","lip_shape_01","lip_size_01","country_residence_01","state_residence_01","over_ear_headphones_01","in_ear_headphones_01","wearing_mask_01","glasses_style_01","glasses_frames_01","glasses_lens_01","wearing_headwear_01","wearing_single_clothing_piece_01","clothing_matches_bg_01","top_clothing_fit_01","bottom_clothing_fit_01","holding_sign_01","holding_phone_01","hands_are_moving_01","hands_stretched_01","pose_01","sitting_or_standing_01","screen_moving_with_person_01","performing_activity_01","participant_id_02","skin_tone_02","gender_02","age_02","hair_length_02","hair_style_02","hair_color_02","beard_length_02","beard_color_02","visible_tattoos_02","eyebrows_thickness_02","eyebrows_style_02","eyes_color_02","eyes_shape_02","eyes_direction_02","eyes_size_02","eye_lids_type_02","nose_shape_02","nose_size_02","lip_shape_02","lip_size_02","country_residence_02","state_residence_02","over_ear_headphones_02","in_ear_headphones_02","wearing_mask_02","glasses_style_02","glasses_frames_02","glasses_lens_02","wearing_headwear_02","wearing_single_clothing_piece_02","clothing_matches_bg_02","top_clothing_fit_02","bottom_clothing_fit_02","holding_sign_02","holding_phone_02","hands_are_moving_02","hands_stretched_02","pose_02","sitting_or_standing_02","screen_moving_with_person_02","performing_activity_02","participant_id_03","skin_tone_03","gender_03","age_03","hair_length_03","hair_style_03","hair_color_03","beard_length_03","beard_color_03","visible_tattoos_03","eyebrows_thickness_03","eyebrows_style_03","eyes_color_03","eyes_shape_03","eyes_direction_03","eyes_size_03","eye_lids_type_03","nose_shape_03","nose_size_03","lip_shape_03","lip_size_03","country_residence_03","state_residence_03","over_ear_headphones_03","in_ear_headphones_03","wearing_mask_03","glasses_style_03","glasses_frames_03","glasses_lens_03","wearing_headwear_03","wearing_single_clothing_piece_03","clothing_matches_bg_03","top_clothing_fit_03","bottom_clothing_fit_03","holding_sign_03","holding_phone_03","hands_are_moving_03","hands_stretched_03","pose_03","sitting_or_standing_03","screen_moving_with_person_03","performing_activity_03","activity"]
final_table=dfvsf[final_cols]
#converting all to lower case
final_table = final_table.applymap(lambda s: s.lower() if type(s) == str else s)
#Replacing values
final_table = final_table.replace(['yes'],'true')
final_table = final_table.replace(['no'],'false')
#Getting action data
final_table["action"]=final_table["file_url"]
final_table.loc[final_table['action'].str.contains('dance'), 'action'] = 'dance'
final_table.loc[final_table['action'].str.contains('activity'), 'action'] = 'other_activity'
final_table.loc[final_table['action'].str.contains('walk'), 'action'] = 'walk'


final_table.to_csv("C:\\Users\\subha\\Appen\\Falcon Multi Persons Video Collection 2021 - Documents\\Buir_LRAC\\Reports\\Buir_qa_report_merged.csv", index=False)
#final_table.to_csv("C:\\Users\\subha\\Desktop\\Buir QA report test\\Buir_qa_report_merged.csv")

# datetime object containing current date and time
now = datetime.now()
#print("now =", now)
# dd/mm/YY H:M:S
dt_string = now.strftime("%d/%m/%Y %H:%M:%S")
print("date and time =", dt_string)
print("-End-")
